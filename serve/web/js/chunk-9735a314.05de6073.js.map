{"version":3,"sources":["webpack:///./src/views/BlogsDetails.vue?e10e","webpack:///./src/views/BlogsDetails.vue?f21a","webpack:///./src/plugins/build-toc.js","webpack:///src/views/BlogsDetails.vue","webpack:///./src/views/BlogsDetails.vue?a0e6","webpack:///./src/views/BlogsDetails.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","vLoading","staticClass","style","blogsDetails","_v","_s","title","description","class","isShowMenu","directives","name","rawName","value","expression","on","$event","ref","domProps","content","_l","item","key","id","paddingLeft","text","scrollTo","getBlogsComments","parentComments","staticRenderFns","prefixID","htmlPart","idMatches","match","parseInt","Math","random","replace","buildToc","article","toc","indent","prefix","push","minItendent","min","apply","map","forEach","components","$route","params","imgUrl","articleToc","getBlogsDetails","methods","res","$axios","get","data","tocData","console","log","$nextTick","blogsComments","filter","c","node","document","querySelector","scrollIntoView","behavior","block","inline","component"],"mappings":"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","file":"js/chunk-9735a314.05de6073.js","sourcesContent":["import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./BlogsDetails.vue?vue&type=style&index=0&id=f43c3474&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./BlogsDetails.vue?vue&type=style&index=0&id=f43c3474&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-loading',{attrs:{\"vLoading\":_vm.vLoading}},[_c('div',{staticClass:\"header-img\",style:((\"background: url(\" + (_vm.blogsDetails.imgUrl) + \") no-repeat top right/cover\"))},[_c('div',{staticClass:\"shadow-dialog\"},[_c('div',{staticClass:\"container container-text\"},[_c('h1',{staticClass:\"fs-8xl\"},[_vm._v(_vm._s(_vm.blogsDetails.title))]),_c('p',{staticClass:\"fs-2xl\"},[_vm._v(_vm._s(_vm.blogsDetails.description))])])])]),_c('container-body',{attrs:{\"isGrey\":true,\"isWhite\":true}},[_c('div',{staticClass:\"blogs-box d-flex pb-5 pr\"},[_c('div',{staticClass:\"blogs-content flex-1\",class:{'pr-4 border-right': _vm.isShowMenu}},[_c('div',{staticClass:\"d-flex jc-between ai-center mb-5\"},[_c('h2',{staticClass:\"m-0 article-zw\"},[_c('i',{staticClass:\"col-primary\"},[_vm._v(\"# \")]),_vm._v(\"正文 \")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isShowMenu),expression:\"!isShowMenu\"}],staticClass:\"hover-gradient fs-2xl col-grey-1\",on:{\"click\":function($event){_vm.isShowMenu = true}}},[_vm._v(\"「 显示目录 」\")])]),_c('div',{directives:[{name:\"highlight\",rawName:\"v-highlight\"}],ref:\"article\",staticClass:\"article markdown-body\",domProps:{\"innerHTML\":_vm._s(_vm.blogsDetails.content)}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowMenu),expression:\"isShowMenu\"}],staticClass:\"blogs-menu pl-4 toc-sticky\"},[_c('div',{staticClass:\"d-flex jc-between ai-center mb-5\"},[_c('h2',{staticClass:\"m-0\"},[_c('i',{staticClass:\"col-primary\"},[_vm._v(\"# \")]),_vm._v(\"TOC \")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowMenu),expression:\"isShowMenu\"}],staticClass:\"hover-gradient fs-2xl col-grey-1\",on:{\"click\":function($event){_vm.isShowMenu = false}}},[_vm._v(\"「 隐藏目录 」\")])]),_vm._l((_vm.articleToc),function(item){return _c('div',{key:item.id,staticClass:\"menu-title text-ellipsis\",style:({paddingLeft: ((item.indent) + \"em\")}),attrs:{\"title\":item.text},on:{\"click\":function($event){return _vm.scrollTo(item.id)}}},[_vm._v(_vm._s(item.text))])})],2)]),_c('div',{staticClass:\"fs-2xl\"},[_c('h2',{},[_c('i',{staticClass:\"col-primary\"},[_vm._v(\"# \")]),_vm._v(\"评论 \")]),_c('comment-textarea',{attrs:{\"model\":\"comments\",\"type\":\"parent\",\"blogsId\":_vm.id,\"placeholder\":\"大家请坐下，陈独秀同志，要发言了。。。\"},on:{\"toResponse\":_vm.getBlogsComments}}),_c('comment-list',{attrs:{\"model\":\"comments\",\"commentsList\":_vm.parentComments,\"blogsId\":_vm.id},on:{\"getCommentList\":_vm.getBlogsComments}})],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nfunction prefixID (htmlPart) {\n\tlet idMatches = htmlPart.match(/^<h\\d\\s[^>]*data-id=(?:\"|')([^\"']+)/)\n\tlet id = ''\n\tif (idMatches) {\n\t\tid = idMatches[1]\n\t} else {\n\t\tid = parseInt(Math.random() * 1000, 10) + '_' + parseInt(Math.random() * 100 * 100)\n\t\thtmlPart = htmlPart.replace(/(^<h\\d)/, `$1 data-id=\"${id}\" `)\n\t}\n\treturn {\n\t\thtmlPart,\n\t\tid\n\t}\n}\nfunction buildToc (article) {\n\tvar toc = []\n\tarticle = article.replace(/<h(\\d)(?:\\s[^>]+)*>([^<]+)/g, (htmlPart, indent, text) => {\n\t\tlet prefix = prefixID(htmlPart, indent, text)\n\t\ttoc.push({\n\t\t\tindent,\n\t\t\ttext,\n\t\t\tid: prefix.id\n\t\t})\n\t\treturn prefix.htmlPart\n\t})\n\tlet minItendent = Math.min.apply(Math, toc.map(item => item.indent))\n\ttoc.forEach(item => {\n\t\titem.indent = item.indent - minItendent\n\t})\n\treturn {\n\t\tarticle,\n\t\ttoc\n\t}\n}\n\nexport default buildToc\n","<template>\n  <div>\n    <v-loading :vLoading=\"vLoading\">\n    <div\n      class=\"header-img\"\n      :style=\"`background: url(${blogsDetails.imgUrl}) no-repeat top right/cover`\"\n    >\n      <div class=\"shadow-dialog\">\n        <div class=\"container container-text\">\n          <h1 class=\"fs-8xl\">{{blogsDetails.title}}</h1>\n          <p class=\"fs-2xl\">{{blogsDetails.description}}</p>\n        </div>\n      </div>\n    </div>\n    <container-body :isGrey=\"true\" :isWhite=\"true\">     \n        <div class=\"blogs-box d-flex pb-5 pr\">\n          <div class=\"blogs-content flex-1\" :class=\"{'pr-4 border-right': isShowMenu}\">\n            <div class=\"d-flex jc-between ai-center mb-5\">\n              <h2 class=\"m-0 article-zw\">\n                <i class=\"col-primary\"># </i>正文\n              </h2>\n              <span\n                v-show=\"!isShowMenu\"\n                class=\"hover-gradient fs-2xl col-grey-1\"\n                @click=\"isShowMenu = true\"\n              >「 显示目录 」</span>\n            </div>\n            <div\n              v-highlight\n              class=\"article markdown-body\"\n              ref=\"article\"\n              v-html=\"blogsDetails.content\"\n            ></div>\n          </div>\n          <div class=\"blogs-menu pl-4 toc-sticky\" v-show=\"isShowMenu\">\n            <div class=\"d-flex jc-between ai-center mb-5\">\n              <h2 class=\"m-0\">\n                <i class=\"col-primary\"># </i>TOC\n              </h2>\n              <span\n                v-show=\"isShowMenu\"\n                class=\"hover-gradient fs-2xl col-grey-1\"\n                @click=\"isShowMenu = false\"\n              >「 隐藏目录 」</span>\n            </div>\n            <div\n              class=\"menu-title text-ellipsis\"\n              :title=\"item.text\"\n              v-for=\"item in articleToc\"\n              :key=\"item.id\"\n              :style=\"{paddingLeft: `${item.indent}em`}\"\n              @click=\"scrollTo(item.id)\"\n            >{{item.text}}</div>\n          </div>\n        </div>\n      <div class=\"fs-2xl\">\n        <h2 class=\"\">\n          <i class=\"col-primary\"># </i>评论\n        </h2>\n        <comment-textarea\n          model=\"comments\"\n          @toResponse=\"getBlogsComments\"\n          type=\"parent\"\n          :blogsId=\"id\"\n          placeholder=\"大家请坐下，陈独秀同志，要发言了。。。\"\n        ></comment-textarea>\n        <comment-list model=\"comments\" @getCommentList=\"getBlogsComments\" :commentsList=\"parentComments\" :blogsId=\"id\"></comment-list>\n      </div>\n    </container-body>\n    </v-loading>\n  </div>\n</template>\n\n<script>\nimport buildToc from \"../plugins/build-toc.js\";\n// import highlight from '../plugins/highlight.js'\nimport marked from \"marked\";\nimport { addLineAndCopy } from \"../plugins/lineAndCopy\";\nexport default {\n  components: {\n  },\n  data() {\n    return {\n      vLoading: true,\n      isShowMenu: true,\n      id: this.$route.params.id,\n      blogsDetails: {\n        imgUrl: \"\"\n      },\n      articleToc: [],\n      parentComments: []\n    };\n  },\n  created() {\n    this.getBlogsComments();\n  },\n  mounted() {\n    this.getBlogsDetails();\n  },\n  methods: {\n    async getBlogsDetails() {\n      let res = await this.$axios.get(`/blogs/${this.id}`);\n      this.blogsDetails = res.data;\n      let tocData = buildToc(marked(res.data.content));\n      console.log(tocData);\n      this.blogsDetails.content = tocData.article;\n      this.articleToc = tocData.toc;\n      this.vLoading = false\n      this.$nextTick(() => {\n        addLineAndCopy();\n        // this.addCodeSupport()\n      });\n    },\n    addCodeSupport() {\n      // 代码高亮\n      // let codeList = this.$refs.article.querySelectorAll('pre code')\n      // \tcodeList.forEach(codeNode => highlight(codeNode))\n    },\n    async getBlogsComments() {\n      let res = await this.$axios.get(`/comments/${this.id}`);\n      console.log(res);\n      let blogsComments = res.data;\n      this.parentComments = blogsComments.filter(\n        v => v.parent == \"5e52a80981bf76430fd982f0\"\n      )\n      this.parentComments.forEach(c => {\n        return (c.children = blogsComments.filter(v => v.parent == c._id));\n      })\n    },\n    scrollTo(id) {\n      // 绑定 toc 点击事件\n      let node = document.querySelector('[data-id=\"' + id + '\"]');\n      if (!node) {\n        return;\n      }\n      node.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"center\",\n        inline: \"nearest\"\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.header-img {\n  width: 100%;\n  height: 300px;\n  position: relative;\n  //   background: no-repeat center center/cover;\n  .shadow-dialog {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background-color: rgba(21, 21, 21, 0.7);\n    color: #fff;\n    .container-text {\n      height: 100%;\n      padding: 130px 20px 56px;\n    }\n  }\n}\n.article-zw {\n  line-height: 32px;\n}\n.blogs-box {\n  min-height: 500px;\n  display: -webkit-box;\n  display: flex;\n  // -webkit-box-orient: horizontal;\n  // -webkit-box-direction: normal;\n  // // flex-flow: row nowrap;\n  // position: relative;\n  -webkit-box-align: start;\n  align-items: flex-start;\n}\n.blogs-content {\n  overflow: hidden;\n  .article {\n    line-height: 1.5;\n  }\n}\n.blogs-menu {\n  width: 220px;\n  line-height: 1.3;\n  // transition: 0.2s;\n  .menu-title {\n    cursor: pointer;\n    font-size: 14px;\n    padding: 5px 0;\n    color: #0366d6;\n    // transition: 0.2s;\n    &:hover {\n      text-decoration: underline;\n    }\n  }\n}\n.toc-sticky {\n  position: -webkit-sticky;\n  position: sticky;\n  top: 91px;\n  flex-shrink: 0;\n}\n@media screen and (max-width: 768px) {\n  .blogs-content {\n    padding-right: 0;\n  }\n  .border-right {\n    border-right: none;\n  }\n  .blogs-menu {\n    display: none;\n  }\n}\n</style>","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./BlogsDetails.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./BlogsDetails.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BlogsDetails.vue?vue&type=template&id=f43c3474&scoped=true&\"\nimport script from \"./BlogsDetails.vue?vue&type=script&lang=js&\"\nexport * from \"./BlogsDetails.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BlogsDetails.vue?vue&type=style&index=0&id=f43c3474&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f43c3474\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}